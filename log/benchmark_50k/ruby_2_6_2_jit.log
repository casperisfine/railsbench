$ RUBYOPT="--jit -v" bundle exec puma -e production --workers=4 --threads=1 --preload
ruby 2.6.2p47 (2019-03-13 revision 67232) +JIT [x86_64-linux]

$ ab -n 50000 -c 4 localhost:3000/posts/1 && ab -n 10000 -c 4 localhost:3000/posts/1
This is ApacheBench, Version 2.3 <$Revision: 1807734 $>
Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/
Licensed to The Apache Software Foundation, http://www.apache.org/

Benchmarking localhost (be patient)
Completed 5000 requests
Completed 10000 requests
Completed 15000 requests
Completed 20000 requests
Completed 25000 requests
Completed 30000 requests
Completed 35000 requests
Completed 40000 requests
Completed 45000 requests
Completed 50000 requests
Finished 50000 requests


Server Software:
Server Hostname:        localhost
Server Port:            3000

Document Path:          /posts/1
Document Length:        929 bytes

Concurrency Level:      4
Time taken for tests:   63.808 seconds
Complete requests:      50000
Failed requests:        0
Total transferred:      81622100 bytes
HTML transferred:       46450000 bytes
Requests per second:    783.60 [#/sec] (mean)
Time per request:       5.105 [ms] (mean)
Time per request:       1.276 [ms] (mean, across all concurrent requests)
Transfer rate:          1249.20 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0    0   0.0      0       1
Processing:     2    5  10.1      3     720
Waiting:        2    5   9.9      3     715
Total:          2    5  10.1      3     720

Percentage of the requests served within a certain time (ms)
  50%      3
  66%      3
  75%      5
  80%      7
  90%     10
  95%     15
  98%     19
  99%     21
 100%    720 (longest request)
This is ApacheBench, Version 2.3 <$Revision: 1807734 $>
Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/
Licensed to The Apache Software Foundation, http://www.apache.org/

Benchmarking localhost (be patient)
Completed 1000 requests
Completed 2000 requests
Completed 3000 requests
Completed 4000 requests
Completed 5000 requests
Completed 6000 requests
Completed 7000 requests
Completed 8000 requests
Completed 9000 requests
Completed 10000 requests
Finished 10000 requests


Server Software:
Server Hostname:        localhost
Server Port:            3000

Document Path:          /posts/1
Document Length:        929 bytes

Concurrency Level:      4
Time taken for tests:   7.258 seconds
Complete requests:      10000
Failed requests:        0
Total transferred:      16324028 bytes
HTML transferred:       9290000 bytes
Requests per second:    1377.71 [#/sec] (mean)
Time per request:       2.903 [ms] (mean)
Time per request:       0.726 [ms] (mean, across all concurrent requests)
Transfer rate:          2196.26 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0    0   0.0      0       0
Processing:     2    3   0.5      3      14
Waiting:        2    3   0.5      3      14
Total:          2    3   0.5      3      14

Percentage of the requests served within a certain time (ms)
  50%      3
  66%      3
  75%      3
  80%      3
  90%      3
  95%      3
  98%      5
  99%      6
 100%     14 (longest request)
/home/k0kubun/src/github.com/k0kubun/railsbench † bionic status: 0                                                            (git)-[master]-
$ gl
079b629 2019-03-17 02:37:53 +0900 Takashi Kokubun Add /posts/1 results for 50k  (HEAD -> master, mine/master)
ed03311 2019-03-17 02:33:17 +0900 Takashi Kokubun Fix typo
5659c4f 2019-03-17 02:30:08 +0900 Takashi Kokubun Fix typo again
45429b5 2019-03-17 02:27:20 +0900 Takashi Kokubun Add 50k benchmark results
7c08150 2019-03-17 02:06:04 +0900 Takashi Kokubun Clarify indy is also used for Graal
6b44127 2019-03-17 02:05:15 +0900 Takashi Kokubun Fix typo
d2083e3 2019-03-17 01:59:19 +0900 Takashi Kokubun Started to write bin/bench
ad4edd3 2019-03-17 01:55:06 +0900 Takashi Kokubun Re-measure CRuby
b012b9f 2019-03-16 21:49:42 +0900 Takashi Kokubun Re-measure JRuby
609e39e 2019-03-16 21:10:20 +0900 Takashi Kokubun Fix broken benchmark results %                                                             /home/k0kubun/src/github.com/k0kubun/railsbench † bionic status: 0                                                            (git)-[master]-
$ gl
079b629 2019-03-17 02:37:53 +0900 Takashi Kokubun Add /posts/1 results for 50k  (HEAD -> master, mine/master)
ed03311 2019-03-17 02:33:17 +0900 Takashi Kokubun Fix typo
5659c4f 2019-03-17 02:30:08 +0900 Takashi Kokubun Fix typo again
45429b5 2019-03-17 02:27:20 +0900 Takashi Kokubun Add 50k benchmark results
7c08150 2019-03-17 02:06:04 +0900 Takashi Kokubun Clarify indy is also used for Graal
6b44127 2019-03-17 02:05:15 +0900 Takashi Kokubun Fix typo
d2083e3 2019-03-17 01:59:19 +0900 Takashi Kokubun Started to write bin/bench
ad4edd3 2019-03-17 01:55:06 +0900 Takashi Kokubun Re-measure CRuby
b012b9f 2019-03-16 21:49:42 +0900 Takashi Kokubun Re-measure JRuby
609e39e 2019-03-16 21:10:20 +0900 Takashi Kokubun Fix broken benchmark results %                                                             /home/k0kubun/src/github.com/k0kubun/railsbench † bionic status: 0                                                            (git)-[master]-
$ git add .
/home/k0kubun/src/github.com/k0kubun/railsbench † bionic status: 0                                                            (git)-[master]-
$ gs
On branch master
Changes to be committed:
  (use "git reset HEAD <file>..." to unstage)

        modified:   Gemfile.lock

/home/k0kubun/src/github.com/k0kubun/railsbench † bionic status: 0                                                            (git)-[master]-
$ ga "Use Gemfile.lock sharable between MRI and JRuby"
[master 9ff0b86] Use Gemfile.lock sharable between MRI and JRuby
 1 file changed, 19 insertions(+)
/home/k0kubun/src/github.com/k0kubun/railsbench † bionic status: 0                                                            (git)-[master]-
$ gl
9ff0b86 2019-03-17 10:42:06 +0900 Takashi Kokubun Use Gemfile.lock sharable between MRI and JRuby  (HEAD -> master)
079b629 2019-03-17 02:37:53 +0900 Takashi Kokubun Add /posts/1 results for 50k  (mine/master)
ed03311 2019-03-17 02:33:17 +0900 Takashi Kokubun Fix typo
5659c4f 2019-03-17 02:30:08 +0900 Takashi Kokubun Fix typo again
45429b5 2019-03-17 02:27:20 +0900 Takashi Kokubun Add 50k benchmark results
7c08150 2019-03-17 02:06:04 +0900 Takashi Kokubun Clarify indy is also used for Graal
6b44127 2019-03-17 02:05:15 +0900 Takashi Kokubun Fix typo
d2083e3 2019-03-17 01:59:19 +0900 Takashi Kokubun Started to write bin/bench
ad4edd3 2019-03-17 01:55:06 +0900 Takashi Kokubun Re-measure CRuby
b012b9f 2019-03-16 21:49:42 +0900 Takashi Kokubun Re-measure JRuby %                                                                         /home/k0kubun/src/github.com/k0kubun/railsbench † bionic status: 0                                                            (git)-[master]-
$ gl
9ff0b86 2019-03-17 10:42:06 +0900 Takashi Kokubun Use Gemfile.lock sharable between MRI and JRuby  (HEAD -> master)
079b629 2019-03-17 02:37:53 +0900 Takashi Kokubun Add /posts/1 results for 50k  (mine/master)
ed03311 2019-03-17 02:33:17 +0900 Takashi Kokubun Fix typo
5659c4f 2019-03-17 02:30:08 +0900 Takashi Kokubun Fix typo again
45429b5 2019-03-17 02:27:20 +0900 Takashi Kokubun Add 50k benchmark results
7c08150 2019-03-17 02:06:04 +0900 Takashi Kokubun Clarify indy is also used for Graal
6b44127 2019-03-17 02:05:15 +0900 Takashi Kokubun Fix typo
d2083e3 2019-03-17 01:59:19 +0900 Takashi Kokubun Started to write bin/bench
ad4edd3 2019-03-17 01:55:06 +0900 Takashi Kokubun Re-measure CRuby
b012b9f 2019-03-16 21:49:42 +0900 Takashi Kokubun Re-measure JRuby %                                                                         /home/k0kubun/src/github.com/k0kubun/railsbench † bionic status: 0                                                            (git)-[master]-
$ gp mine
Counting objects: 3, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (3/3), done.
Writing objects: 100% (3/3), 612 bytes | 612.00 KiB/s, done.
Total 3 (delta 2), reused 0 (delta 0)
remote: Resolving deltas: 100% (2/2), completed with 2 local objects.
To github.com:k0kubun/railsbench
   079b629..9ff0b86  master -> master
/home/k0kubun/src/github.com/k0kubun/railsbench † bionic status: 0                                                            (git)-[master]-
$ puma --help
puma <options> <rackup file>
    -b, --bind URI                   URI to bind to (tcp://, unix://, ssl://)
    -C, --config PATH                Load PATH as a config file
        --control-url URL            The bind url to use for the control server. Use 'auto' to use temp unix server
        --control URL                DEPRECATED alias for --control-url
        --control-token TOKEN        The token to use as authentication for the control server
    -d, --daemon                     Daemonize the server into the background
        --debug                      Log lowlevel debugging information
        --dir DIR                    Change to DIR before starting
    -e, --environment ENVIRONMENT    The environment to run the Rack app on (default development)
    -I, --include PATH               Specify $LOAD_PATH directories
    -p, --port PORT                  Define the TCP port to bind to
                                     Use -b for more advanced options
        --pidfile PATH               Use PATH as a pidfile
        --preload                    Preload the app. Cluster mode only
        --prune-bundler              Prune out the bundler env if possible
    -q, --quiet                      Do not log requests internally (default true)
    -v, --log-requests               Log requests as they occur
    -R, --restart-cmd CMD            The puma command to run during a hot restart
                                     Default: inferred
    -S, --state PATH                 Where to store the state details
    -t, --threads INT                min:max threads to use (default 0:16)
        --tcp-mode                   Run the app in raw TCP mode instead of HTTP mode
        --early-hints                Enable early hints support
    -V, --version                    Print the version information
    -w, --workers COUNT              Activate cluster mode: How many worker processes to create
        --tag NAME                   Additional text to display in process listing
        --redirect-stdout FILE       Redirect STDOUT to a specific file
        --redirect-stderr FILE       Redirect STDERR to a specific file
        --[no-]redirect-append       Append to redirected files
/home/k0kubun/src/github.com/k0kubun/railsbench † bionic status: 0                                                            (git)-[master]-
$ ab -n 50000 -c 4 localhost:3000/posts/1 && ab -n 10000 -c 4 localhost:3000/posts/1
/home/k0kubun/src/github.com/k0kubun/railsbench † bionic status: 0                                                            (git)-[master]-
$ ab -n 50000 -c 4 localhost:3000/posts/1 && ab -n 10000 -c 4 localhost:3000/posts/1
This is ApacheBench, Version 2.3 <$Revision: 1807734 $>
Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/
Licensed to The Apache Software Foundation, http://www.apache.org/

Benchmarking localhost (be patient)
Completed 5000 requests
^C

Server Software:
Server Hostname:        localhost
Server Port:            3000

Document Path:          /posts/1
Document Length:        929 bytes

Concurrency Level:      4
Time taken for tests:   6.958 seconds
Complete requests:      6447
Failed requests:        0
Total transferred:      10525344 bytes
HTML transferred:       5990192 bytes
Requests per second:    926.52 [#/sec] (mean)
Time per request:       4.317 [ms] (mean)
Time per request:       1.079 [ms] (mean, across all concurrent requests)
Transfer rate:          1477.19 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0    0   0.0      0       0
Processing:     2    4   2.2      4      35
Waiting:        2    4   2.1      3      35
Total:          2    4   2.2      4      35

Percentage of the requests served within a certain time (ms)
  50%      4
  66%      4
  75%      4
  80%      5
  90%      6
  95%      8
  98%     12
  99%     15
 100%     35 (longest request)
/home/k0kubun/src/github.com/k0kubun/railsbench † bionic status: 1                                                            (git)-[master]-
$ ab -n 50000 -c 4 localhost:3000/posts/1 && ab -n 10000 -c 4 localhost:3000/posts/1
/home/k0kubun/src/github.com/k0kubun/railsbench † bionic status: 1                                                            (git)-[master]-
$ ab -n 50000 -c 4 localhost:3000/posts/1 && ab -n 10000 -c 4 localhost:3000/posts/1
This is ApacheBench, Version 2.3 <$Revision: 1807734 $>
Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/
Licensed to The Apache Software Foundation, http://www.apache.org/

Benchmarking localhost (be patient)
Completed 5000 requests
Completed 10000 requests
Completed 15000 requests
Completed 20000 requests
Completed 25000 requests
Completed 30000 requests
Completed 35000 requests
Completed 40000 requests
Completed 45000 requests
Completed 50000 requests
Finished 50000 requests


Server Software:
Server Hostname:        localhost
Server Port:            3000

Document Path:          /posts/1
Document Length:        929 bytes

Concurrency Level:      4
Time taken for tests:   60.707 seconds
Complete requests:      50000
Failed requests:        0
Total transferred:      81620780 bytes
HTML transferred:       46450000 bytes
Requests per second:    823.63 [#/sec] (mean)
Time per request:       4.857 [ms] (mean)
Time per request:       1.214 [ms] (mean, across all concurrent requests)
Transfer rate:          1313.00 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0    0   0.0      0       1
Processing:     2    5   2.5      4      77
Waiting:        2    5   2.5      4      77
Total:          2    5   2.5      4      77

Percentage of the requests served within a certain time (ms)
  50%      4
  66%      4
  75%      5
  80%      5
  90%      7
  95%      9
  98%     14
  99%     16
 100%     77 (longest request)
This is ApacheBench, Version 2.3 <$Revision: 1807734 $>
Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/
Licensed to The Apache Software Foundation, http://www.apache.org/

Benchmarking localhost (be patient)
Completed 1000 requests
Completed 2000 requests
Completed 3000 requests
Completed 4000 requests
Completed 5000 requests
Completed 6000 requests
Completed 7000 requests
Completed 8000 requests
Completed 9000 requests
Completed 10000 requests
Finished 10000 requests


Server Software:
Server Hostname:        localhost
Server Port:            3000

Document Path:          /posts/1
Document Length:        929 bytes

Concurrency Level:      4
Time taken for tests:   13.438 seconds
Complete requests:      10000
Failed requests:        0
Total transferred:      16324422 bytes
HTML transferred:       9290000 bytes
Requests per second:    744.18 [#/sec] (mean)
Time per request:       5.375 [ms] (mean)
Time per request:       1.344 [ms] (mean, across all concurrent requests)
Transfer rate:          1186.36 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0    0   0.0      0       0
Processing:     2    5   2.7      4      37
Waiting:        2    5   2.6      4      33
Total:          2    5   2.7      4      37

Percentage of the requests served within a certain time (ms)
  50%      4
  66%      5
  75%      5
  80%      6
  90%      8
  95%     10
  98%     15
  99%     17
 100%     37 (longest request)
